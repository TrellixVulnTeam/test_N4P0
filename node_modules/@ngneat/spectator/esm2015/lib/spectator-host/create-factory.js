import { TestBed, waitForAsync } from '@angular/core/testing';
import { By } from '@angular/platform-browser';
import { BrowserDynamicTestingModule } from '@angular/platform-browser-dynamic/testing';
import { setProps } from '../internals/query';
import * as customMatchers from '../matchers';
import { overrideComponentIfProviderOverridesSpecified, overrideModules } from '../spectator/create-factory';
import { addMatchers } from '../core';
import { isType } from '../types';
import { nodeByDirective } from '../internals/node-by-directive';
import { initialSpectatorWithHostModule } from './initial-module';
import { getSpectatorHostDefaultOptions } from './options';
import { SpectatorHost } from './spectator-host';
export function createHostFactory(typeOrOptions) {
    const options = isType(typeOrOptions)
        ? getSpectatorHostDefaultOptions({ component: typeOrOptions })
        : getSpectatorHostDefaultOptions(typeOrOptions);
    const moduleMetadata = initialSpectatorWithHostModule(options);
    beforeEach(waitForAsync(() => {
        addMatchers(customMatchers);
        TestBed.configureTestingModule(moduleMetadata).overrideModule(BrowserDynamicTestingModule, {
            set: {
                entryComponents: moduleMetadata.entryComponents
            }
        });
        overrideModules(options);
        overrideComponentIfProviderOverridesSpecified(options);
        if (options.template) {
            TestBed.overrideComponent(options.host, {
                set: { template: options.template }
            });
        }
    }));
    return (template, overrides) => {
        const defaults = { props: {}, hostProps: {}, detectChanges: true, providers: [] };
        const { detectChanges, props, hostProps, providers } = Object.assign(Object.assign({}, defaults), overrides);
        if (providers && providers.length) {
            providers.forEach((provider) => {
                TestBed.overrideProvider(provider.provide, provider);
            });
        }
        if (template) {
            TestBed.overrideComponent(options.host, {
                set: { template: template }
            });
        }
        const spectator = createSpectatorHost(options, props, hostProps);
        if (options.detectChanges && detectChanges) {
            spectator.detectChanges();
        }
        return spectator;
    };
}
function createSpectatorHost(options, props, hostProps) {
    const hostFixture = TestBed.createComponent(options.host);
    const debugElement = hostFixture.debugElement.query(By.directive(options.component)) || hostFixture.debugElement;
    const debugNode = hostFixture.debugElement.queryAllNodes(nodeByDirective(options.component))[0];
    if (!debugNode) {
        throw new Error(`Cannot find component/directive ${options.component} in host template ðŸ˜”`);
    }
    const hostComponent = setProps(hostFixture.componentInstance, hostProps);
    const component = setProps(debugNode.injector.get(options.component), props);
    return new SpectatorHost(hostComponent, hostFixture.debugElement, hostFixture.nativeElement, hostFixture, debugElement, component, debugElement.nativeElement);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLWZhY3RvcnkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9zcGVjdGF0b3Ivc3JjL2xpYi9zcGVjdGF0b3ItaG9zdC9jcmVhdGUtZmFjdG9yeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzlELE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSwyQ0FBMkMsQ0FBQztBQUV4RixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDOUMsT0FBTyxLQUFLLGNBQWMsTUFBTSxhQUFhLENBQUM7QUFDOUMsT0FBTyxFQUFFLDZDQUE2QyxFQUFFLGVBQWUsRUFBc0IsTUFBTSw2QkFBNkIsQ0FBQztBQUNqSSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDbEMsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBR2pFLE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ2xFLE9BQU8sRUFBRSw4QkFBOEIsRUFBd0IsTUFBTSxXQUFXLENBQUM7QUFDakYsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBbUNqRCxNQUFNLFVBQVUsaUJBQWlCLENBQXVCLGFBQW1EO0lBQ3pHLE1BQU0sT0FBTyxHQUFHLE1BQU0sQ0FBQyxhQUFhLENBQUM7UUFDbkMsQ0FBQyxDQUFDLDhCQUE4QixDQUFPLEVBQUUsU0FBUyxFQUFFLGFBQWEsRUFBRSxDQUFDO1FBQ3BFLENBQUMsQ0FBQyw4QkFBOEIsQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUVsRCxNQUFNLGNBQWMsR0FBRyw4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S0FBSyxDQUFDLENBQUM7SUFFN0UsT0FBTyxJQUFJLGFBQWEsQ0FDdEIsYUFBYSxFQUNiLFdBQVcsQ0FBQyxZQUFZLEVBQ3hCLFdBQVcsQ0FBQyxhQUFhLEVBQ3pCLFdBQVcsRUFDWCxZQUFZLEVBQ1osU0FBUyxFQUNULFlBQVksQ0FBQyxhQUFhLENBQzNCLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJvdmlkZXIsIFR5cGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFRlc3RCZWQsIHdhaXRGb3JBc3luYyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvdGVzdGluZyc7XG5pbXBvcnQgeyBCeSB9IGZyb20gJ0Bhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXInO1xuaW1wb3J0IHsgQnJvd3NlckR5bmFtaWNUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlci1keW5hbWljL3Rlc3RpbmcnO1xuXG5pbXBvcnQgeyBzZXRQcm9wcyB9IGZyb20gJy4uL2ludGVybmFscy9xdWVyeSc7XG5pbXBvcnQgKiBhcyBjdXN0b21NYXRjaGVycyBmcm9tICcuLi9tYXRjaGVycyc7XG5pbXBvcnQgeyBvdmVycmlkZUNvbXBvbmVudElmUHJvdmlkZXJPdmVycmlkZXNTcGVjaWZpZWQsIG92ZXJyaWRlTW9kdWxlcywgU3BlY3RhdG9yT3ZlcnJpZGVzIH0gZnJvbSAnLi4vc3BlY3RhdG9yL2NyZWF0ZS1mYWN0b3J5JztcbmltcG9ydCB7IGFkZE1hdGNoZXJzIH0gZnJvbSAnLi4vY29yZSc7XG5pbXBvcnQgeyBpc1R5cGUgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBub2RlQnlEaXJlY3RpdmUgfSBmcm9tICcuLi9pbnRlcm5hbHMvbm9kZS1ieS1kaXJlY3RpdmUnO1xuXG5pbXBvcnQgeyBIb3N0Q29tcG9uZW50IH0gZnJvbSAnLi9ob3N0LWNvbXBvbmVudCc7XG5pbXBvcnQgeyBpbml0aWFsU3BlY3RhdG9yV2l0aEhvc3RNb2R1bGUgfSBmcm9tICcuL2luaXRpYWwtbW9kdWxlJztcbmltcG9ydCB7IGdldFNwZWN0YXRvckhvc3REZWZhdWx0T3B0aW9ucywgU3BlY3RhdG9ySG9zdE9wdGlvbnMgfSBmcm9tICcuL29wdGlvbnMnO1xuaW1wb3J0IHsgU3BlY3RhdG9ySG9zdCB9IGZyb20gJy4vc3BlY3RhdG9yLWhvc3QnO1xuXG4vKipcbiAqIEBwdWJsaWNBcGlcbiAqL1xuZXhwb3J0IHR5cGUgU3BlY3RhdG9ySG9zdEZhY3Rvcnk8QywgSD4gPSA8SFA+KFxuICB0ZW1wbGF0ZTogc3RyaW5nLFxuICBvdmVycmlkZXM/OiBTcGVjdGF0b3JIb3N0T3ZlcnJpZGVzPEMsIEgsIEhQPlxuKSA9PiBTcGVjdGF0b3JIb3N0PEMsIEggJiAoSG9zdENvbXBvbmVudCBleHRlbmRzIEggPyBIUCA6IHVua25vd24pPjtcblxuLyoqXG4gKiBAcHVibGljQXBpXG4gKi9cbmV4cG9ydCB0eXBlIFByZXNldFNwZWN0YXRvckhvc3RGYWN0b3J5PEMsIEg+ID0gPEhQPihcbiAgdGVtcGxhdGU/OiBzdHJpbmcsXG4gIG92ZXJyaWRlcz86IFNwZWN0YXRvckhvc3RPdmVycmlkZXM8QywgSCwgSFA+XG4pID0+IFNwZWN0YXRvckhvc3Q8QywgSCAmIChIb3N0Q29tcG9uZW50IGV4dGVuZHMgSCA/IEhQIDogdW5rbm93bik+O1xuXG4vKipcbiAqIEBwdWJsaWNBcGlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTcGVjdGF0b3JIb3N0T3ZlcnJpZGVzPEMsIEgsIEhQPiBleHRlbmRzIFNwZWN0YXRvck92ZXJyaWRlczxDPiB7XG4gIGhvc3RQcm9wcz86IEhvc3RDb21wb25lbnQgZXh0ZW5kcyBIID8gSFAgOiBQYXJ0aWFsPEg+O1xufVxuXG4vKipcbiAqIEBwdWJsaWNBcGlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUhvc3RGYWN0b3J5PEMsIEggPSBIb3N0Q29tcG9uZW50PihcbiAgb3B0aW9uczogU3BlY3RhdG9ySG9zdE9wdGlvbnM8QywgSD4gJiB7IHRlbXBsYXRlOiBzdHJpbmcgfVxuKTogUHJlc2V0U3BlY3RhdG9ySG9zdEZhY3Rvcnk8QywgSD47XG4vKipcbiAqIEBwdWJsaWNBcGlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUhvc3RGYWN0b3J5PEMsIEggPSBIb3N0Q29tcG9uZW50Pih0eXBlT3JPcHRpb25zOiBUeXBlPEM+IHwgU3BlY3RhdG9ySG9zdE9wdGlvbnM8QywgSD4pOiBTcGVjdGF0b3JIb3N0RmFjdG9yeTxDLCBIPjtcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVIb3N0RmFjdG9yeTxDLCBIID0gSG9zdENvbXBvbmVudD4odHlwZU9yT3B0aW9uczogVHlwZTxDPiB8IFNwZWN0YXRvckhvc3RPcHRpb25zPEMsIEg+KTogU3BlY3RhdG9ySG9zdEZhY3Rvcnk8QywgSD4ge1xuICBjb25zdCBvcHRpb25zID0gaXNUeXBlKHR5cGVPck9wdGlvbnMpXG4gICAgPyBnZXRTcGVjdGF0b3JIb3N0RGVmYXVsdE9wdGlvbnM8QywgSD4oeyBjb21wb25lbnQ6IHR5cGVPck9wdGlvbnMgfSlcbiAgICA6IGdldFNwZWN0YXRvckhvc3REZWZhdWx0T3B0aW9ucyh0eXBlT3JPcHRpb25zKTtcblxuICBjb25zdCBtb2R1bGVNZXRhZGF0YSA9IGluaXRpYWxTcGVjdGF0b3JXaXRoSG9zdE1vZHVsZTxDLCBIPihvcHRpb25zKTtcblxuICBiZWZvcmVFYWNoKFxuICAgIHdhaXRGb3JBc3luYygoKSA9PiB7XG4gICAgICBhZGRNYXRjaGVycyhjdXN0b21NYXRjaGVycyk7XG4gICAgICBUZXN0QmVkLmNvbmZpZ3VyZVRlc3RpbmdNb2R1bGUobW9kdWxlTWV0YWRhdGEpLm92ZXJyaWRlTW9kdWxlKEJyb3dzZXJEeW5hbWljVGVzdGluZ01vZHVsZSwge1xuICAgICAgc2V0OiB7XG4gICAgICAgIGVudHJ5Q29tcG9uZW50czogbW9kdWxlTWV0YWRhdGEuZW50cnlDb21wb25lbnRzXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAgIG92ZXJyaWRlTW9kdWxlcyhvcHRpb25zKTtcblxuICAgICAgb3ZlcnJpZGVDb21wb25lbnRJZlByb3ZpZGVyT3ZlcnJpZGVzU3BlY2lmaWVkKG9wdGlvbnMpO1xuICAgICAgaWYgKG9wdGlvbnMudGVtcGxhdGUpIHtcbiAgICAgICAgVGVzdEJlZC5vdmVycmlkZUNvbXBvbmVudChvcHRpb25zLmhvc3QsIHtcbiAgICAgICAgICAgc2V0OiB7IHRlbXBsYXRlOiBvcHRpb25zLnRlbXBsYXRlIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSlcbiAgKTtcblxuICByZXR1cm4gPEhQPih0ZW1wbGF0ZT86IHN0cmluZywgb3ZlcnJpZGVzPzogU3BlY3RhdG9ySG9zdE92ZXJyaWRlczxDLCBILCBIUD4pID0+IHtcbiAgICBjb25zdCBkZWZhdWx0czogU3BlY3RhdG9ySG9zdE92ZXJyaWRlczxDLCBILCBIUD4gPSB7IHByb3BzOiB7fSwgaG9zdFByb3BzOiB7fSBhcyBhbnksIGRldGVjdENoYW5nZXM6IHRydWUsIHByb3ZpZGVyczogW10gfTtcbiAgICBjb25zdCB7IGRldGVjdENoYW5nZXMsIHByb3BzLCBob3N0UHJvcHMsIHByb3ZpZGVycyB9ID0geyAuLi5kZWZhdWx0cywgLi4ub3ZlcnJpZGVzIH07XG5cbiAgICBpZiAocHJvdmlkZXJzICYmIHByb3ZpZGVycy5sZW5ndGgpIHtcbiAgICAgIHByb3ZpZGVycy5mb3JFYWNoKChwcm92aWRlcjogUHJvdmlkZXIpID0+IHtcbiAgICAgICAgVGVzdEJlZC5vdmVycmlkZVByb3ZpZGVyKChwcm92aWRlciBhcyBhbnkpLnByb3ZpZGUsIHByb3ZpZGVyIGFzIGFueSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodGVtcGxhdGUpIHtcbiAgICAgIFRlc3RCZWQub3ZlcnJpZGVDb21wb25lbnQob3B0aW9ucy5ob3N0LCB7XG4gICAgICAgIHNldDogeyB0ZW1wbGF0ZTogdGVtcGxhdGUgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3Qgc3BlY3RhdG9yID0gY3JlYXRlU3BlY3RhdG9ySG9zdChvcHRpb25zLCBwcm9wcywgaG9zdFByb3BzKTtcblxuICAgIGlmIChvcHRpb25zLmRldGVjdENoYW5nZXMgJiYgZGV0ZWN0Q2hhbmdlcykge1xuICAgICAgc3BlY3RhdG9yLmRldGVjdENoYW5nZXMoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3BlY3RhdG9yO1xuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVTcGVjdGF0b3JIb3N0PEMsIEgsIEhQPihcbiAgb3B0aW9uczogUmVxdWlyZWQ8U3BlY3RhdG9ySG9zdE9wdGlvbnM8QywgSD4+LFxuICBwcm9wcz86IFBhcnRpYWw8Qz4sXG4gIGhvc3RQcm9wcz86IEhQXG4pOiBTcGVjdGF0b3JIb3N0PEMsIEggJiBIUD4ge1xuICBjb25zdCBob3N0Rml4dHVyZSA9IFRlc3RCZWQuY3JlYXRlQ29tcG9uZW50KG9wdGlvbnMuaG9zdCk7XG4gIGNvbnN0IGRlYnVnRWxlbWVudCA9IGhvc3RGaXh0dXJlLmRlYnVnRWxlbWVudC5xdWVyeShCeS5kaXJlY3RpdmUob3B0aW9ucy5jb21wb25lbnQpKSB8fCBob3N0Rml4dHVyZS5kZWJ1Z0VsZW1lbnQ7XG4gIGNvbnN0IGRlYnVnTm9kZSA9IGhvc3RGaXh0dXJlLmRlYnVnRWxlbWVudC5xdWVyeUFsbE5vZGVzKG5vZGVCeURpcmVjdGl2ZShvcHRpb25zLmNvbXBvbmVudCkpWzBdO1xuXG4gIGlmICghZGVidWdOb2RlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgZmluZCBjb21wb25lbnQvZGlyZWN0aXZlICR7b3B0aW9ucy5jb21wb25lbnR9IGluIGhvc3QgdGVtcGxhdGUg8J+YlGApO1xuICB9XG5cbiAgY29uc3QgaG9zdENvbXBvbmVudCA9IHNldFByb3BzKGhvc3RGaXh0dXJlLmNvbXBvbmVudEluc3RhbmNlLCBob3N0UHJvcHMpO1xuICBjb25zdCBjb21wb25lbnQgPSBzZXRQcm9wcyhkZWJ1Z05vZGUuaW5qZWN0b3IuZ2V0KG9wdGlvbnMuY29tcG9uZW50KSwgcHJvcHMpO1xuXG4gIHJldHVybiBuZXcgU3BlY3RhdG9ySG9zdChcbiAgICBob3N0Q29tcG9uZW50LFxuICAgIGhvc3RGaXh0dXJlLmRlYnVnRWxlbWVudCxcbiAgICBob3N0Rml4dHVyZS5uYXRpdmVFbGVtZW50LFxuICAgIGhvc3RGaXh0dXJlLFxuICAgIGRlYnVnRWxlbWVudCxcbiAgICBjb21wb25lbnQsXG4gICAgZGVidWdFbGVtZW50Lm5hdGl2ZUVsZW1lbnRcbiAgKTtcbn1cbiJdfQ==
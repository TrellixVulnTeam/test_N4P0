"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.installDependencies = void 0;
const tasks_1 = require("@angular-devkit/schematics/tasks");
const child_process_1 = require("child_process");
const package_1 = require("../utils/package");
function installDependencies(options) {
    return (host, context) => {
        const deps = [
            {
                name: "@commitlint/cli",
                version: "^12.0.1",
            },
            {
                name: "@commitlint/config-conventional",
                version: "^12.0.1",
            },
            {
                name: "all-contributors-cli",
                version: "^6.20.0",
            },
            {
                name: "lint-staged",
                version: "^10.5.4",
            },
            {
                name: "prettier",
                version: "^2.2.1",
            },
            {
                name: "husky",
                version: "^5.1.2",
            },
            {
                name: "cross-env",
                version: "^7.0.3",
            },
            {
                name: "@types/jasmine",
                version: "~3.6.0",
            },
            {
                name: "commitizen",
                version: "^4.2.4",
            },
        ];
        if (!options.skipLib) {
            if (!options.skipSpectator) {
                // install spectator synchronously so we can use it for external schematics command later on.
                child_process_1.execSync("npm install --silent --save-dev @ngneat/spectator", {
                    windowsHide: true,
                });
                deps.push({ name: "@ngneat/spectator", version: "^8.0.2" });
            }
            if (!options.skipAngularCliGhPages) {
                // install angular-cli-ghpages synchronously so we can use it for external schematics command later on.
                child_process_1.execSync("npm install --silent --save-dev angular-cli-ghpages", {
                    windowsHide: true,
                });
                deps.push({ name: "angular-cli-ghpages", version: "^1.0.0-rc.1" });
            }
        }
        const addPackageToPackageJson = package_1.addPackageToPackageJsonFactory(host, "devDependencies");
        deps.forEach((dep) => {
            addPackageToPackageJson(dep.name, dep.version);
        });
        context.addTask(new tasks_1.NodePackageInstallTask());
        context.logger.log("info", "âŒ› Adding packages...");
        return host;
    };
}
exports.installDependencies = installDependencies;
//# sourceMappingURL=add-dependencies.js.map